



<div class="container py-4 header-m mt-5 " translate="no">
  <div class="form-card">
    <!-- <ngx-spinner bdOpacity=0.9 bdColor="rgba(51, 51, 51, 0.8)" size="medium" color="#fff"
			type="ball-spin-clockwise">
		</ngx-spinner> -->
    <!-- Can go in app.component.html for global spinner -->
    <ngx-spinner
    bdColor="rgba(0, 0, 0, 0.8)"
    size="medium"
    color="#ffffff"
    type="ball-scale-multiple"
    [fullScreen]="true">
  </ngx-spinner>
    



    <form [formGroup]="updateTempleForm" class="p-5">
      <div class="row mt-5">
        <h3 class="section-header-title text-center">Edit a Temple</h3>
      </div>
      <div class="temple-form-heading">
        
        <hr />
        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="templeName">Temple Name *</label>
              <input type="text" class="form-control" id="templeName" formControlName="name" placeholder="Enter the Temple Name">
              <div *ngIf="updateTempleForm.get('name')?.invalid && (updateTempleForm.get('name')?.dirty || updateTempleForm.get('name')?.touched)" class="text-danger">
                Temple Name is required
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="templeName">Diety Name *</label>
              <input type="text" class="form-control" id="templeName" formControlName="diety" placeholder="Enter the Diety Name">
              <div *ngIf="updateTempleForm.get('diety')?.invalid && (updateTempleForm.get('name')?.dirty || updateTempleForm.get('diety')?.touched)" class="text-danger">
                Diety Name is required
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="templeCategory">Temple Category *</label>
              <select class="form-control" id="templeCategory" formControlName="category">
                <option *ngFor="let option of templeCategoryOptions" [value]="option.value">{{ option.label }}</option>
              </select>
              <div *ngIf="updateTempleForm.get('category')?.invalid && (updateTempleForm.get('category')?.dirty || updateTempleForm.get('category')?.touched)" class="text-danger">
                Temple Category is required
              </div>
            </div>
          </div>
        </div>

        
        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="style">Temple Style *</label>
              <select class="form-control" id="style" formControlName="style">
                <option *ngFor="let option of templeStyleOptions" [value]="option.value">{{ option.label }}</option>
              </select>
              <div *ngIf="updateTempleForm.get('style')?.invalid && (updateTempleForm.get('style')?.dirty || updateTempleForm.get('style')?.touched)" class="text-danger">
                Temple style is required
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="priority">Temple Priority *</label>
              <select class="form-control" id="priority" formControlName="priority">
                <option *ngFor="let option of templePriorityOptions" [value]="option.value">{{ option.label }}</option>
              </select>
              <div *ngIf="updateTempleForm.get('priority')?.invalid && (updateTempleForm.get('priority')?.dirty || updateTempleForm.get('priority')?.touched)" class="text-danger">
                Temple Priority is required
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="is_navagraha_established">Is Navagraha Established</label>
              <select class="form-control" id="is_navagraha_established" formControlName="is_navagraha_established">
                <option [ngValue]="true">Yes</option>
                <option [ngValue]="false">No</option>
              </select>
              <div *ngIf="updateTempleForm.get('is_navagraha_established')?.invalid && (updateTempleForm.get('is_navagraha_established')?.dirty || updateTempleForm.get('is_navagraha_established')?.touched)" class="text-danger">
                Please select an option
              </div>
            </div>
          </div>
        </div>



        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="contact_name">Contact Name </label>
              <input type="text" class="form-control" id="contact_name" formControlName="contact_name" placeholder="Enter the Contact Name">

            </div>
          </div>

          <div class="col-md-4">
            <div class="form-group">
              <label for="contact_email">Contact Email </label>
              <input type="text" class="form-control" id="contact_email" formControlName="contact_email" placeholder="Enter the Contact Email">

            </div>
          </div>

          <div class="col-md-4">
            <div class="form-group">
              <label for="contact_phone">Contact Number </label>
              <input type="number" class="form-control" id="contact_phone" formControlName="contact_phone" placeholder="Enter the Contact Number">

            </div>
          </div>
        </div>



        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="temple_official_website">Temple Official Website</label>
              <input type="url" class="form-control"
                     id="temple_official_website"
                     formControlName="temple_official_website"
                     placeholder="Enter the Temple Official Website">
                     
              <p style="font-size: 13px;">Provide the correct URL (e.g., http://example.com)</p>
            
              <div *ngIf="updateTempleForm.get('temple_official_website')?.invalid && updateTempleForm.get('temple_official_website')?.touched" style="color: red; font-size: 13px;">
                Please enter a valid URL. Example: http://example.com
              </div>
            </div>
            
          </div>
          <div class="col-md-4"> 
            <div class="form-group">
              <label for="temple_area">Temple Area</label>
              <input type="text" class="form-control" id="temple_area" formControlName="temple_area" placeholder="Enter the Temple Area">


            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="animal_sacrifice_status">Temple Timings</label>
              <input type="time" class="form-control" id="temple_area" formControlName="temple_timings" placeholder="Enter the Temple Timings">


            </div>
          </div>
        </div>






        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="construction_year">Temple Construction Year</label>
              <input type="text" class="form-control" id="construction_year" formControlName="construction_year" placeholder="Enter the Temple Construction Year">
              <div *ngIf="updateTempleForm.get('construction_year')?.invalid && (updateTempleForm.get('construction_year')?.dirty || updateTempleForm.get('construction_year')?.touched)" class="text-danger">
                Construction year is required
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="is_destroyed">Is Destroyed</label>
              <select class="form-control" id="is_destroyed" formControlName="is_destroyed">
                <option [ngValue]="true">Yes</option>
                <option [ngValue]="false">No</option>
              </select>
              <div *ngIf="updateTempleForm.get('is_destroyed')?.invalid && (updateTempleForm.get('is_destroyed')?.dirty || updateTempleForm.get('is_destroyed')?.touched)" class="text-danger">
                Please select an option
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="animal_sacrifice_status">Animal Sacrifice Status</label>
              <select class="form-control" id="animal_sacrifice_status" formControlName="animal_sacrifice_status">
                <option [ngValue]="true">Yes</option>
                <option [ngValue]="false">No</option>
              </select>
              <div *ngIf="updateTempleForm.get('animal_sacrifice_status')?.invalid && (updateTempleForm.get('animal_sacrifice_status')?.dirty || updateTempleForm.get('animal_sacrifice_status')?.touched)" class="text-danger">
                Please select an option
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="form-group">
              <label for="desc">About The Temple</label>
              <textarea class="form-control" id="desc" formControlName="desc" placeholder="Describe about the temple in less than 4500 words" rows="5"></textarea>
              <div *ngIf="updateTempleForm.get('desc')?.invalid && (updateTempleForm.get('desc')?.dirty || updateTempleForm.get('desc')?.touched)" class="text-danger">
                
                <div *ngIf="updateTempleForm.get('desc')?.errors?.['maxlength']">Description cannot be more than 4500 words</div>
              </div>
            </div>
          </div>
        </div>
       


        <div class="row">
          <div class="col-md-12">
            <div class="form-group">
              <label for="temple_map_location">Temple Map Location (URL) *</label>
              <div class="input-group">
                <input
                  type="url"
                  class="form-control"
                  id="temple_map_location"
                  formControlName="temple_map_location"
                  placeholder="https://example.com/map"
                />
                <div class="input-group-append">
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="getCurrentLocation()"
                    title="Fetch Current Location"
                  >
                    üìç Get Location
                  </button>
                </div>
              </div>
              <small class="form-text text-muted">
                Please provide a valid URL for the temple's map location.
              </small>
              <div
                *ngIf="updateTempleForm.get('temple_map_location')?.invalid && (updateTempleForm.get('temple_map_location')?.dirty || updateTempleForm.get('temple_map_location')?.touched)"
                class="text-danger"
              >
                Please enter a valid URL for the Temple Map Location.
              </div>
            </div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="address">Total Address *</label>
              <textarea class="form-control" id="address" formControlName="address" placeholder="Total Address" rows="2"></textarea>
              <div *ngIf="updateTempleForm.get('address')?.invalid && (updateTempleForm.get('address')?.dirty || updateTempleForm.get('address')?.touched)" class="text-danger">
                Address is required
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="form-group">
              <label for="status">Status</label>
              <select class="form-control" id="status" formControlName="status">
                <option value="ACTIVE">ACTIVE</option>
                <option value="INACTIVE">INACTIVE</option>
              </select>
              <div *ngIf="updateTempleForm.get('status')?.invalid && (updateTempleForm.get('status')?.dirty || updateTempleForm.get('status')?.touched)" class="text-danger">
                Please select an option
              </div>
            </div>
          </div>
          
        </div>





        
        <div class="row"  >
          <div class="col-md-4">
            <nz-form-item>
              <nz-form-control nzErrorTip="Please select a country">
                <label for="country">Country*</label>
                <nz-select formControlName="country"nzPlaceHolder="Select country" [nzShowSearch]="true"  nzNotFoundContent="No data found">
                  <nz-option *ngFor="let option of templeCountryOptions" [nzValue]="option.value" [nzLabel]="option.label"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="col-md-4">
            <nz-form-item>
              <nz-form-control nzErrorTip="State is required">
                <label for="state">State*</label>
                <nz-select formControlName="state" nzPlaceHolder="Select state" [nzShowSearch]="true" nzNotFoundContent="No data found">
                  <nz-option *ngFor="let option of templeStateOptions" [nzValue]="option.value"  [nzLabel]="option.label"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="col-md-4">
            <nz-form-item>
              <nz-form-control nzErrorTip="District is required">
                <label for="district">District*</label>
                <nz-select formControlName="district" nzPlaceHolder="Select district" [nzShowSearch]="true" nzNotFoundContent="No data found">
                  <nz-option *ngFor="let option of templeDistrictOptions" [nzValue]="option.value" [nzLabel]="option.label"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="col-md-4">
            <nz-form-item>
              <nz-form-control nzErrorTip="Mandal is required">
                <label for="mandal">Mandal*</label>
                <nz-select formControlName="mandal" nzPlaceHolder="Select Mandal" [nzShowSearch]="true" nzNotFoundContent="No data found">
                  <nz-option *ngFor="let option of templeMandalOptions" [nzValue]="option.value" [nzLabel]="option.label"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="col-md-4">
            <nz-form-item>
              <nz-form-control nzErrorTip="Village is required">
                <label for="village">Village*</label>
                <nz-select formControlName="object_id" nzPlaceHolder="Select village" [nzShowSearch]="true" nzNotFoundContent="No data found">
                  <nz-option *ngFor="let option of templeVillageOptions" [nzValue]="option.value" [nzLabel]="option.label"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
  



           <div class="profile-pic-container " formControlName="image_location" (click)="triggerFileInput()">
            
            <img  
                 [src]="'data:image/jpg;base64,' + profileImage" 
                 alt="Profile Picture" 
                 class="profile-pic"
                 (error)="onImageError($event)"
                 />
        
      
      
            
            <ng-template #defaultPic>
              <div class="profile-pic-placeholder">
                <span class="plus-icon">+</span>
              </div>
            </ng-template>
            
            <div class="overlay">
              <span class="edit-icon">+</span>
            </div>
          </div> 
        
      <input
            id="image_location"
            type="file"
            accept="image/*"
            (change)="onFileChange($event)"
            style="display: none;"
            #fileInput
          />
        
          <div *ngIf="updateTempleForm.controls['image_location'].invalid && updateTempleForm.controls['image_location'].touched" class="text-danger">
            Profile Picture is required.
          </div> 



         
          
        <div class="text-center">
          <button type="button" (click)="onSubmit()" style="border-width: 0px;background-color: rgb(241, 124, 15);border-radius:20px;color: white; padding: 10px;"> Submit </button>
        </div>
      </div>
    </form>
  </div>
</div>
